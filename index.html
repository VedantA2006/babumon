<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sorry Babumon ‚ù§Ô∏è</title>

<script src="https://cdn.tailwindcss.com"></script>

<style>
    @import url('https://fonts.googleapis.com/css2?family=Pacifico&family=Inter:wght@400;700&display=swap');

    body {
        font-family: 'Inter', sans-serif;
        background-color: #fce7f3;
        overflow: hidden;
    }

    .screen {
        height: 100vh;
        width: 100vw;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        position: absolute;
        top: 0;
        left: 0;
    }

    .game-area {
        width: 95%;
        max-width: 800px;
        height: 80vh;
        max-height: 600px;
        background: #fff0f6;
        border-radius: 20px;
        border: 4px solid #f9a8d4;
        box-shadow: 0 10px 20px rgba(236, 72, 153, 0.3);
        position: relative;
        overflow: hidden;
    }

    .apology-title {
        font-family: 'Pacifico';
        color: #ec4899;
    }

    /* ---------------- Cannon ---------------- */
    #cannon {
        position: absolute;
        bottom: 30px;
        left: 50%;
        transform: translateX(-50%);
        pointer-events: none;
    }

    #barrel {
        width: 80px;
        height: 16px;
        background: linear-gradient(to right, #6366f1, #3b82f6);
        border-radius: 8px;
        position: absolute;
        bottom: 45px; 
        left: 0;
        transform-origin: 0 50%;
        transform: rotate(-90deg);
    }

    #base {
        width: 80px;
        height: 45px;
        background: linear-gradient(to bottom, #a0a0a0, #6b6b6b);
        border-radius: 12px 12px 0 0;
        position: absolute;
        bottom: 0;
        left: 0;
    }

    /* ---------------- Projectile ---------------- */
    .projectile {
        width: 26px;
        height: 26px;
        background: radial-gradient(circle, #ff8aa1, #ff4d6d);
        border-radius: 50%;
        position: absolute;
        box-shadow: 0 0 10px #ff4d6d;
        font-size: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        animation: pulse 0.5s infinite alternate;
    }

    @keyframes pulse { from{transform:scale(1);} to{transform:scale(1.15);} }

    /* ---------------- Target ---------------- */
    #target {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        position: absolute;
        object-fit: cover;
        box-shadow: 0 0 15px #ec4899;
    }

    #target.hit { transform: scale(1.2); }

    /* ---------------- Win Screen ---------------- */
    #win {
        position: absolute;
        inset: 0;
        background: rgba(255,255,255,0.9);
        display: none;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        border-radius: 20px;
        padding: 30px;
        text-align: center;
    }

    #final-photo {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        object-fit: cover;
        box-shadow: 0 0 20px #ec4899;
        border: 4px solid white;
        margin-bottom: 20px;
    }
</style>
</head>

<body>

<!-- Start Screen -->
<div id="start" class="screen">
    <h1 class="apology-title text-7xl mb-10">Sorry Babumon ‚ù§Ô∏è</h1>
    <button id="playBtn" class="bg-pink-500 hover:bg-pink-600 text-white font-bold py-4 px-10 rounded-full text-xl shadow-lg">
        Play The Game
    </button>
</div>

<!-- Game Screen -->
<div id="game" class="screen hidden">

    <div id="score" class="text-xl text-pink-700 mb-2 font-bold">Hits: 0 / 10</div>

    <div id="area" class="game-area">

        <img id="target" src="ph1.jpg">

        <!-- Cannon -->
        <div id="cannon">
            <div id="barrel"></div>
            <div id="base"></div>
        </div>

        <!-- Win message -->
        <div id="win">
            <img id="final-photo" src="ph2.jpg">
            <h2 class="apology-title text-5xl mb-3">You Win!</h2>
            <p class="text-gray-600">My dearest Babumon,

I am truly and deeply sorry for my hurtful words and for making jokes that were cruel. I recognize that my actions caused you pain, and I take full responsibility for that.

I promise you now and forever that I will never speak to you or make fun of you in that way again. You deserve respect and kindness, and I will be more mindful and careful with every word I say to ensure I always treat you with the love and care you deserve.

Please forgive me. I love you more than anything. ‚ù§Ô∏è</p>
        </div>

    </div>

    <p class="text-gray-500 text-sm mt-2">Tap anywhere to shoot!</p>
</div>

<script>

/* ---------- Constants ---------- */
const MAX_HITS = 10;
const PROJ_SIZE = 26;
const BARREL_LENGTH = 80;

/* ---------- State ---------- */
let hits = 0;
let running = false;
let canShoot = true;
let projectiles = [];
let tx = 50, ty = 50;
let tvx = 2, tvy = 1.5;

let cannonX = 0, cannonY = 0;

/* ---------- Elements ---------- */
const start = document.getElementById("start");
const game = document.getElementById("game");
const area = document.getElementById("area");
const score = document.getElementById("score");
const target = document.getElementById("target");
const win = document.getElementById("win");
const barrel = document.getElementById("barrel");

/* ---------- Setup ---------- */
function setup() {
    cannonX = area.clientWidth / 2;
    cannonY = area.clientHeight - 60;
    target.style.left = tx + "px";
    target.style.top = ty + "px";
}

/* ---------- Start Game ---------- */
document.getElementById("playBtn").onclick = () => {
    start.classList.add("hidden");
    game.classList.remove("hidden");
    hits = 0;
    running = true;
    canShoot = true;
    score.textContent = "Hits: 0 / 10";
    setup();
};

/* ---------- Shooting ---------- */
function getPos(e) {
    const r = area.getBoundingClientRect();
    const x = (e.touches ? e.touches[0].clientX : e.clientX) - r.left;
    const y = (e.touches ? e.touches[0].clientY : e.clientY) - r.top;
    return { x, y };
}

function shoot(e) {
    if (!running || !canShoot || hits >= MAX_HITS) return;

    canShoot = false;
    setTimeout(() => canShoot = true, 150);

    const { x, y } = getPos(e);
    const dx = x - cannonX;
    const dy = y - cannonY;

    let angle = Math.atan2(dy, dx);
    if (angle > 0) angle = 0;

    barrel.style.transform = `rotate(${angle}rad)`;

    const speed = 17;
    const startX = cannonX + Math.cos(angle) * BARREL_LENGTH;
    const startY = cannonY + Math.sin(angle) * BARREL_LENGTH;

    const el = document.createElement("div");
    el.className = "projectile";
    el.textContent = "üíñ";
    el.style.left = (startX - PROJ_SIZE/2) + "px";
    el.style.top = (startY - PROJ_SIZE/2) + "px";
    area.appendChild(el);

    projectiles.push({
        el,
        x: startX - PROJ_SIZE/2,
        y: startY - PROJ_SIZE/2,
        vx: speed * Math.cos(angle),
        vy: speed * Math.sin(angle)
    });
}

area.addEventListener("mousedown", shoot);
area.addEventListener("touchstart", shoot);

/* ---------- Game Loop ---------- */
function loop() {
    if (running) {
        updateTarget();
        updateProjectiles();
        checkHit();
    }
    requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

function updateTarget() {
    tx += tvx; ty += tvy;

    const maxX = area.clientWidth - 100;
    const maxY = area.clientHeight - 100;

    if (tx < 0 || tx > maxX) tvx *= -1;
    if (ty < 0 || ty > maxY) tvy *= -1;

    target.style.left = tx + "px";
    target.style.top = ty + "px";
}

function updateProjectiles() {
    const newList = [];
    projectiles.forEach(p => {
        p.x += p.vx;
        p.y += p.vy;

        if (p.x > -40 && p.x < area.clientWidth + 40 &&
            p.y > -40 && p.y < area.clientHeight + 40) {

            p.el.style.left = p.x + "px";
            p.el.style.top = p.y + "px";
            newList.push(p);
        } else {
            p.el.remove();
        }
    });
    projectiles = newList;
}

function checkHit() {
    const cx = tx + 50;
    const cy = ty + 50;

    const remaining = [];

    for (const p of projectiles) {
        const px = p.x + PROJ_SIZE / 2;
        const py = p.y + PROJ_SIZE / 2;

        if (Math.hypot(px - cx, py - cy) < 63) {
            hits++;
            score.textContent = `Hits: ${hits} / 10`;
            p.el.remove();
            target.classList.add("hit");
            setTimeout(() => target.classList.remove("hit"), 150);
        } else remaining.push(p);
    }

    projectiles = remaining;

    if (hits >= 10) endGame();
}

function endGame() {
    running = false;
    win.style.display = "flex";
}

</script>

</body>
</html>
